# Ansible роль для деплоя echo-server и балансировщика nginx

## Описание

Данная роль Ansible автоматизирует установку Docker, запуск трёх экземпляров контейнера echo-server из приватного Docker Registry и настройку nginx в качестве балансировщика нагрузки.

- Устанавливается Docker CE и nginx.
- Запускаются три контейнера echo-server на разных портах.
- nginx настраивается как балансировщик между этими контейнерами.

## Стратегия балансировки

В конфигурации nginx используется стратегия `round-robin` (по умолчанию):

```nginx
upstream echo_backend {
    server 127.0.0.1:8001;
    server 127.0.0.1:8002;
    server 127.0.0.1:8003;
}
```

### Обоснование выбора

Стратегия `round-robin` равномерно распределяет входящие запросы между всеми backend-серверами по очереди. Такой подход прост в реализации и хорошо подходит для приложений, где каждый запрос обрабатывается примерно за одинаковое время, как в случае с echo-server.

В отличие от других стратегий, например, `least_conn`, round-robin не требует дополнительного анализа состояния backend-серверов и обеспечивает предсказуемое распределение нагрузки.

**Вывод:**  
`round-robin` — универсальный и надёжный выбор для балансировки нагрузки между идентичными экземплярами stateless-приложений, таких как echo-server.

## Использование

1. Укажите параметры подключения к хосту в `inventory.ini`.
2. Задайте переменные в `vault.yml` (например, пароль от Docker Registry).
3. Запустите playbook:
   ```bash
   ansible-playbook playbook.yml --ask-vault-pass 
   ```

Все параметры и детали настройки описаны в соответствующих файлах роли.
